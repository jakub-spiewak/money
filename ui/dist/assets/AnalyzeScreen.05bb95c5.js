import{ac as He,E as ie,K as Me,L as Le,ad as $e,j as n,R as N,M as E,J as R,ae as je,af as Ke,r as c,ag as Ve,ah as We,ai as Ge,aj as Ue,ak as Je,al as Qe,am as G,an as k,c as f,I as qe,ao as Xe,B as ce,w as Ye,C as te,ap as Ze,T as U,aq as eo,a as oo,a0 as no,F as ro}from"./index.941be39d.js";import{c as le,f as ue,T as $,a as w,b as to,g as so,d as ao,e as h,h as io}from"./index.esm.a4d225f8.js";import{D as co,P as lo}from"./index.27113c7c.js";function uo(o){return"current"in o}var de=()=>typeof window<"u";function po(){var e;const o=navigator.userAgentData;return(e=o==null?void 0:o.platform)!=null?e:navigator.platform}var vo=o=>de()&&o.test(navigator.vendor),fo=o=>de()&&o.test(po()),mo=()=>fo(/mac|iphone|ipad|ipod/i),ho=()=>mo()&&vo(/apple/i);function go(o){const{ref:e,elements:r,enabled:t}=o,a=()=>{var l;var s;return(l=(s=e.current)==null?void 0:s.ownerDocument)!=null?l:document};He(a,"pointerdown",s=>{if(!ho()||!t)return;const l=s.target,x=(r!=null?r:[e]).some(p=>{const b=uo(p)?p.current:p;return(b==null?void 0:b.contains(l))||b===l});a().activeElement!==l&&x&&(s.preventDefault(),l.focus())})}var B=(...o)=>o.filter(Boolean).join(" ");function xo(o,...e){return yo(o)?o(...e):o}var yo=o=>typeof o=="function";function g(...o){return function(r){o.some(t=>(t==null||t(r),r==null?void 0:r.defaultPrevented))}}function Po(...o){return function(r){o.forEach(t=>{t==null||t(r)})}}var[bo,T]=ie({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[Co,F]=ie({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `}),S={click:"click",hover:"hover"};function wo(o={}){const{closeOnBlur:e=!0,closeOnEsc:r=!0,initialFocusRef:t,id:a,returnFocusOnClose:s=!0,autoFocus:l=!0,arrowSize:d,arrowShadowColor:x,trigger:p=S.click,openDelay:b=200,closeDelay:z=200,isLazy:Pe,lazyBehavior:be="unmount",computePositionOnMount:Ce,...we}=o,{isOpen:v,onClose:y,onOpen:j,onToggle:Q}=Ve(o),K=c.exports.useRef(null),I=c.exports.useRef(null),A=c.exports.useRef(null),_=c.exports.useRef(!1),q=c.exports.useRef(!1);v&&(q.current=!0);const[X,Te]=c.exports.useState(!1),[Y,Ae]=c.exports.useState(!1),Se=c.exports.useId(),Ne=a!=null?a:Se,[Z,D,O,H]=["popover-trigger","popover-content","popover-header","popover-body"].map(i=>`${i}-${Ne}`),{referenceRef:M,getArrowProps:Ee,getPopperProps:ee,getArrowInnerProps:_e,forceUpdate:ke}=We({...we,enabled:v||!!Ce}),oe=Ge({isOpen:v,ref:A});go({enabled:v,ref:I}),Ue(A,{focusRef:I,visible:v,shouldFocus:s&&p===S.click}),Je(A,{focusRef:t,visible:v,shouldFocus:l&&p===S.click});const ne=Qe({wasSelected:q.current,enabled:Pe,mode:be,isSelected:oe.present}),Re=c.exports.useCallback((i={},m=null)=>{const u={...i,style:{...i.style,transformOrigin:G.transformOrigin.varRef,[G.arrowSize.var]:d?`${d}px`:void 0,[G.arrowShadowColor.var]:x},ref:k(A,m),children:ne?i.children:null,id:D,tabIndex:-1,role:"dialog",onKeyDown:g(i.onKeyDown,P=>{r&&P.key==="Escape"&&y()}),onBlur:g(i.onBlur,P=>{const L=se(P),W=J(A.current,L),Oe=J(I.current,L);v&&e&&(!W&&!Oe)&&y()}),"aria-labelledby":X?O:void 0,"aria-describedby":Y?H:void 0};return p===S.hover&&(u.role="tooltip",u.onMouseEnter=g(i.onMouseEnter,()=>{_.current=!0}),u.onMouseLeave=g(i.onMouseLeave,P=>{P.nativeEvent.relatedTarget!==null&&(_.current=!1,setTimeout(()=>y(),z))})),u},[ne,D,X,O,Y,H,p,r,y,v,e,z,x,d]),Be=c.exports.useCallback((i={},m=null)=>ee({...i,style:{visibility:v?"visible":"hidden",...i.style}},m),[v,ee]),Fe=c.exports.useCallback((i,m=null)=>({...i,ref:k(m,K,M)}),[K,M]),C=c.exports.useRef(),V=c.exports.useRef(),re=c.exports.useCallback(i=>{K.current==null&&M(i)},[M]),ze=c.exports.useCallback((i={},m=null)=>{const u={...i,ref:k(I,m,re),id:Z,"aria-haspopup":"dialog","aria-expanded":v,"aria-controls":D};return p===S.click&&(u.onClick=g(i.onClick,Q)),p===S.hover&&(u.onFocus=g(i.onFocus,()=>{C.current===void 0&&j()}),u.onBlur=g(i.onBlur,P=>{const L=se(P),W=!J(A.current,L);v&&e&&W&&y()}),u.onKeyDown=g(i.onKeyDown,P=>{P.key==="Escape"&&y()}),u.onMouseEnter=g(i.onMouseEnter,()=>{_.current=!0,C.current=window.setTimeout(()=>j(),b)}),u.onMouseLeave=g(i.onMouseLeave,()=>{_.current=!1,C.current&&(clearTimeout(C.current),C.current=void 0),V.current=window.setTimeout(()=>{_.current===!1&&y()},z)})),u},[Z,v,D,p,re,Q,j,e,y,b,z]);c.exports.useEffect(()=>()=>{C.current&&clearTimeout(C.current),V.current&&clearTimeout(V.current)},[]);const Ie=c.exports.useCallback((i={},m=null)=>({...i,id:O,ref:k(m,u=>{Te(!!u)})}),[O]),De=c.exports.useCallback((i={},m=null)=>({...i,id:H,ref:k(m,u=>{Ae(!!u)})}),[H]);return{forceUpdate:ke,isOpen:v,onAnimationComplete:oe.onComplete,onClose:y,getAnchorProps:Fe,getArrowProps:Ee,getArrowInnerProps:_e,getPopoverPositionerProps:Be,getPopoverProps:Re,getTriggerProps:ze,getHeaderProps:Ie,getBodyProps:De}}function J(o,e){return o===e||(o==null?void 0:o.contains(e))}function se(o){var r;const e=o.currentTarget.ownerDocument.activeElement;return(r=o.relatedTarget)!=null?r:e}function pe(o){const e=Me("Popover",o),{children:r,...t}=Le(o),a=$e(),s=wo({...t,direction:a.direction});return n(bo,{value:s,children:n(Co,{value:e,children:xo(r,{isOpen:s.isOpen,onClose:s.onClose,forceUpdate:s.forceUpdate})})})}pe.displayName="Popover";function ve(o){var x;const{bg:e,bgColor:r,backgroundColor:t}=o,{getArrowProps:a,getArrowInnerProps:s}=T(),l=F(),d=(x=e!=null?e:r)!=null?x:t;return N.createElement(E.div,{...a(),className:"chakra-popover__arrow-positioner"},N.createElement(E.div,{className:B("chakra-popover__arrow",o.className),...s(o),__css:{...l.arrow,"--popper-arrow-bg":d?`colors.${d}, ${d}`:void 0}}))}ve.displayName="PopoverArrow";var fe=R(function(e,r){const{getBodyProps:t}=T(),a=F();return N.createElement(E.div,{...t(e,r),className:B("chakra-popover__body",e.className),__css:a.body})});fe.displayName="PopoverBody";var me=R(function(e,r){const{onClose:t}=T(),a=F();return n(je,{size:"sm",onClick:t,className:B("chakra-popover__close-btn",e.className),__css:a.closeButton,ref:r,...e})});me.displayName="PopoverCloseButton";function To(o){if(!!o)return{enter:{...o.enter,visibility:"visible"},exit:{...o.exit,transitionEnd:{visibility:"hidden"}}}}var Ao={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},So=E(Ke.section),he=R(function(e,r){const{variants:t=Ao,...a}=e,{isOpen:s}=T();return N.createElement(So,{ref:r,variants:To(t),initial:!1,animate:s?"enter":"exit",...a})});he.displayName="PopoverTransition";var ge=R(function(e,r){const{rootProps:t,motionProps:a,...s}=e,{getPopoverProps:l,getPopoverPositionerProps:d,onAnimationComplete:x}=T(),p=F(),b={position:"relative",display:"flex",flexDirection:"column",...p.content};return N.createElement(E.div,{...d(t),__css:p.popper,className:"chakra-popover__popper"},n(he,{...a,...l(s,r),onAnimationComplete:Po(x,s.onAnimationComplete),className:B("chakra-popover__content",e.className),__css:b}))});ge.displayName="PopoverContent";var xe=R(function(e,r){const{getHeaderProps:t}=T(),a=F();return N.createElement(E.header,{...t(e,r),className:B("chakra-popover__header",e.className),__css:a.header})});xe.displayName="PopoverHeader";function ye(o){const e=c.exports.Children.only(o.children),{getTriggerProps:r}=T();return c.exports.cloneElement(e,r(e.props,e.ref))}ye.displayName="PopoverTrigger";const No=o=>{const{tag:e}=o,{name:r,expenses:t}=e;return f(pe,{isLazy:!0,children:[n(ye,{children:n(qe,{icon:n(Xe,{}),"aria-label":"icon"})}),f(ge,{width:"unset",children:[n(ve,{}),n(me,{}),f(xe,{children:["Info about: ",n("b",{children:r})]}),n(fe,{children:n(le,{variant:"simple",size:"sm",children:n(ue,{children:t==null?void 0:t.map((a,s)=>f($,{children:[n(w,{children:a.name}),n(w,{isNumeric:!0,children:a.amount.toFixed(2)+` (${(a.factor*100).toFixed(2)}%)`})]},`summary_expense_row_${s}`))})})})]})]})},Eo=o=>{const{tags:e}=o;return n(to,{pt:8,maxW:"100vw",flex:2,overflow:"auto",children:f(le,{variant:"simple",children:[n(so,{children:"Summary"}),n(ao,{children:f($,{children:[n(h,{children:"Info"}),n(h,{children:"Name"}),n(h,{isNumeric:!0,children:"Amount"}),n(h,{isNumeric:!0,children:"% of expenses"}),n(h,{isNumeric:!0,children:"% of revenues"})]})}),n(ue,{children:e.map((r,t)=>{const{name:a,amount:s,expensesFactor:l,revenuesFactor:d}=r;return f($,{_hover:{background:"blue.300"},children:[n(w,{children:n(No,{tag:r})}),n(w,{children:a}),n(w,{isNumeric:!0,children:s==null?void 0:s.toFixed(2)}),n(w,{isNumeric:!0,children:`${(l*100).toFixed(2)}%`}),n(w,{isNumeric:!0,children:`${(d*100).toFixed(2)}%`})]},`analyze_tag_${t}`)})}),n(io,{children:f($,{children:[n(h,{children:"Info"}),n(h,{children:"Name"}),n(h,{isNumeric:!0,children:"Amount"}),n(h,{isNumeric:!0,children:"% of expenses"}),n(h,{isNumeric:!0,children:"% of revenues"})]})})]})})},_o=o=>{const{expensesAmount:e,savingAmount:r}=o;return n(ce,{width:"100%",maxW:Ye.breakpoints.sm,flex:1,children:n(co,{data:{labels:["Expense","Savings"],datasets:[{data:[e,r],backgroundColor:["#0bb4ff","#50e991"],hoverOffset:32,borderJoinStyle:"round"}]},options:{layout:{padding:32},responsive:!0}})})},ko=o=>{const{revenueAmount:e,expensesAmount:r,savingAmount:t,expensesPercentage:a,savingPercentage:s}=o;return n(te,{children:n(Ze,{pb:8,maxW:"6xl",children:f(te,{flexDirection:"column",children:[f(U,{fontSize:"4xl",children:["Revenues: ",n("b",{children:e.toLocaleString()})]}),f(U,{fontSize:"xl",children:["Expenses: ",n("b",{children:r.toLocaleString()})," (",a*100,"%)"]}),f(U,{fontSize:"xl",children:["Savings: ",n("b",{children:t.toLocaleString()})," (",s*100,"%)"]})]})})})},Ro=o=>{if(!o)return 0;const{data:e,type:r}=o;switch(r){case"RANGE":return(((e==null?void 0:e.min)||0)+((e==null?void 0:e.max)||0))/2;case"PERCENTAGE":return(e==null?void 0:e.value)||0;case"CONSTANT":return(e==null?void 0:e.value)||0;case"UNKNOWN":return 0;default:return 0}},ae=["#fd7f6f","#7eb0d5","#b2e061","#bd7ebe","#ffb55a","#ffee65","#beb9db","#fdcce5","#8bd3c7"],Bo=o=>ae[o%ae.length],Fo=o=>{const{expenses:e}=o,r=e.map(s=>s.name),t=e.map(s=>Ro(s.amount)),a=e.map((s,l)=>Bo(l));return n(ce,{width:"100%",maxW:[null,null,"4xl"],maxH:"100vh",height:["50vh","100vh","50vh"],mx:"auto",children:n(lo,{data:{labels:r,datasets:[{data:t,backgroundColor:a,hoverOffset:16,borderJoinStyle:"round",offset:4}]},options:{layout:{padding:8,autoPadding:!0},normalized:!0,responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"chartArea",align:"start",fullSize:!1}}}})})},Ho=()=>{const{data:o}=eo({}),{data:e=[]}=oo({});if(!o)return null;const{tags:r=[],expensesAmountSum:t=0,revenueAmountSum:a=0,savingAmountSum:s=0,expensesFactor:l=0,savingFactor:d=0}=o;return f(no,{children:[n(ko,{revenueAmount:a,expensesAmount:t,savingAmount:s,expensesPercentage:l,savingPercentage:d}),f(ro,{gap:8,flexDirection:["column",null,null,null,"row"],alignItems:"center",children:[n(_o,{expensesAmount:t,savingAmount:s}),n(Eo,{tags:r})]}),n(Fo,{expenses:e})]})};export{Ho as default};
