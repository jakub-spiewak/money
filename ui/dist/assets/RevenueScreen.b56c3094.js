import{d as y,c as t,B as d,j as e,a6 as G,F as u,T as h,S as v,x as W,U as R,W as T,I as x,X as w,Y as s,N as M,o as g,O as N,m as _,u as U,P as $,a2 as F,a3 as I,a0 as L,a4 as V,a5 as O,Q as j,v as z,t as B}from"./index.941be39d.js";import{A as H}from"./AmountTableCell.25ecfd0d.js";import{T as b,I as Q,D as Y}from"./index.esm.529e3218.js";import{C as P}from"./CurrentDateComponent.29e6c7df.js";const X=o=>{const{revenue:n}=o,l=y();return t(d,{px:2,children:[e(G,{}),t(u,{alignItems:"center",gap:2,p:2,children:[t(u,{gap:2,w:"full",children:[e(h,{fontWeight:"bold",children:n.name}),e(v,{}),e(h,{children:W(n.amount)})]}),e(v,{}),t(R,{children:[e(T,{as:x,variant:"outline",icon:e(b,{}),size:"sm"}),t(w,{children:[e(s,{icon:e(M,{}),onClick:()=>{var a;l(g({modal:"SINGLE_REVENUE",id:n.id,value:{...n,parentRevenue:(a=n.parentRevenue)==null?void 0:a.id}}))},children:"Edit"}),e(s,{icon:e(N,{}),onClick:()=>{l(_({type:"SINGLE_REVENUE",id:n.id,name:n.name}))},children:"Delete"})]})]})]})]})},q=o=>{var C,f;const{revenue:n}=o,{value:l,month:a,year:c}=U(i=>i.currentDate),r=y(),m=new Date,S=m.getUTCMonth()+1,E=m.getUTCFullYear(),A=c===E&&a===S,k=c<E||c===E&&a<S,{data:D}=$({month:l});return t(u,{w:"100%",flexDirection:"column",children:[t(u,{alignItems:"center",justifyContent:"flex-start",py:2,pl:2,w:"full",children:[t(u,{px:2,flexDirection:"column",children:[e(h,{fontWeight:"bold",children:n.name}),e(d,{fontWeight:"hairline",children:e(H,{amount:n.amount})})]}),e(v,{}),t(R,{children:[e(T,{as:x,variant:"outline",icon:e(b,{}),size:"sm",mr:4}),t(w,{children:[e(s,{icon:e(F,{}),onClick:()=>r(g({modal:"SINGLE_REVENUE",value:{parentRevenue:n.id,date:A?I():new Date(`${l}-${k?J(c,a).toString():"01"}`).toISOString().split("T")[0]}})),children:"Add"}),e(s,{icon:e(M,{}),onClick:()=>r(g({modal:"SCHEDULED_REVENUE",id:n.id,value:n})),children:"Edit"}),e(s,{icon:e(N,{}),onClick:()=>{r(_({type:"SCHEDULED_REVENUE",id:n.id,name:n.name}))},children:"Delete"}),n.amount.type==="CONSTANT"&&t(L,{children:[e(V,{}),e(s,{icon:e(O,{}),onClick:()=>{r(g({modal:"SINGLE_REVENUE",value:{parentRevenue:n.id,amount:n.amount.data.value,name:n.name,date:I()}}))},children:"Create current revenue"})]})]})]})]}),(f=(C=D==null?void 0:D.filter(i=>{var p;return((p=i.parentRevenue)==null?void 0:p.id)===n.id}))==null?void 0:C.sort((i,p)=>new Date(i.date).getTime()-new Date(p.date).getTime()))==null?void 0:f.map(i=>e(X,{revenue:i},`single_revenue_item_${i.id}`))]})};function J(o,n){return new Date(o,n,0).getDate()}const te=()=>{const{year:o,month:n}=U(r=>r.currentDate),l=`${o}-${n<=9?`0${n}`:n}`,{data:a,isFetching:c}=j({month:l});return t(d,{p:4,children:[e(P,{}),t(u,{p:4,backgroundColor:"gray.900",borderRadius:16,borderWidth:1,alignItems:"center",my:4,children:[e(h,{fontSize:"2xl",fontWeight:"hairline",children:"Revenues"}),e(v,{}),c&&e(z,{})]}),t(d,{pb:4,w:"full",children:[a&&a.length===0&&t(d,{px:2,children:[e(d,{p:8,children:e(Q,{src:"/undraw/moonlight.svg"})}),e(B,{children:"No data"}),e(h,{fontSize:"2xl",fontWeight:"hairline",children:"Add revenues with plus button below"})]}),e(Y,{children:a==null?void 0:a.map((r,m)=>e(q,{revenue:r},`group_revenue_item_${m}`))})]})]})};export{te as default};
