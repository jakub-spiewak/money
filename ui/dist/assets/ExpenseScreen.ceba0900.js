import{d as P,c as a,F as S,j as e,T as l,S as w,x as N,U as X,W as U,I as z,X as L,Y as E,N as O,o as I,O as B,m as G,Z as R,g as H,B as c,_ as T,$ as J,w as M,u as Z,b as $,a0 as _,a1 as q,a2 as K,a3 as y,a4 as ee,a5 as te,a6 as j,a7 as ne,a as ae,r as re,v as se,t as ie}from"./index.941be39d.js";import{D as V}from"./index.27113c7c.js";import{C as oe}from"./CurrentDateComponent.29e6c7df.js";import{T as Q,I as ce,D as le}from"./index.esm.529e3218.js";const Y=n=>{const{expense:t}=n,s=P();return a(S,{alignItems:"center",gap:2,p:2,children:[a(S,{gap:2,w:"full",children:[e(l,{fontWeight:"bold",children:t.name}),e(w,{}),e(l,{children:N(t.amount)})]}),a(X,{children:[e(U,{as:z,variant:"outline",icon:e(Q,{}),size:"sm"}),a(L,{children:[e(E,{icon:e(O,{}),onClick:()=>{var i;s(I({modal:"SINGLE_EXPENSE",id:t.id,value:{...t,parentExpense:(i=t.parentExpense)==null?void 0:i.id,tags:t.tags.map(o=>o.id)}}))},children:"Edit"}),e(E,{icon:e(B,{}),onClick:()=>{s(G({type:"SINGLE_EXPENSE",id:t.id,name:t.name}))},children:"Delete"})]})]})]})};function de(n){return R({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Circle_Alert",dataName:"Circle Alert"},child:[{tag:"g",attr:{},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M12.5,9a.5.5,0,0,0-1,0h0V13.02a.5.5,0,0,0,1,0Z"}},{tag:"circle",attr:{cx:"12",cy:"15.001",r:"0.5"}}]},{tag:"path",attr:{d:"M12,21.935A9.933,9.933,0,1,1,21.934,12,9.945,9.945,0,0,1,12,21.935ZM12,3.069A8.933,8.933,0,1,0,20.934,12,8.944,8.944,0,0,0,12,3.069Z"}}]}]}]})(n)}function he(n){return R({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"Dollar"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M12,21.934A9.934,9.934,0,1,1,21.934,12,9.945,9.945,0,0,1,12,21.934ZM12,3.066A8.934,8.934,0,1,0,20.934,12,8.944,8.944,0,0,0,12,3.066Z"}},{tag:"path",attr:{d:"M14.5,13.5a2.006,2.006,0,0,1-2,2v1.01a.5.5,0,0,1-1,0V15.5H10.25a.5.5,0,0,1,0-1H12.5a1,1,0,0,0,0-2h-1a2,2,0,0,1,0-4V7.49a.5.5,0,0,1,1,0V8.5h1.25a.5.5,0,0,1,0,1H11.5a1,1,0,0,0,0,2h1A2.006,2.006,0,0,1,14.5,13.5Z"}}]}]}]})(n)}H.JSX;const pe=n=>{const{value:t,backgroundColor:s,borderColor:i,inside:o}=n;return a(c,{position:"relative",w:"4em",display:"flex",children:[e(V,{options:{offset:0,events:[],plugins:{},responsive:!0},data:{datasets:[{data:[t,100-t],backgroundColor:[s||"white","transparent"],borderColor:i,borderWidth:2}]}}),o&&e(c,{mt:2,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",children:o})]})},ue=n=>{const{expense:{amount:{type:t},status:s,spentFactor:i}}=n;return t==="CONSTANT"&&s==="PAID"?e(T,{as:J,color:"green.500",w:16,h:16,px:2}):t==="CONSTANT"&&s==="UNPAID"?e(T,{as:de,w:16,h:16,px:2,color:"red.500"}):t==="CONSTANT"&&s==="FUTURE"?e(T,{w:16,h:16,px:2,as:he,color:"whiteAlpha.300"}):e(pe,{value:(i>1?1:i)*100,backgroundColor:ge(s)})};function ge(n){switch(n){case"FUTURE":break;case"PAID":break;case"UNPAID":break;case"BELOW_MIN":break;case"BETWEEN_MIN_MAX":return M.colors.green[500];case"EXCEED_MAX":return M.colors.red[500]}}const me=n=>{var f,D;const{expense:t}=n,{value:s,month:i,year:o}=Z(r=>r.currentDate),C=new Date,b=C.getUTCMonth()+1,h=C.getUTCFullYear(),A=o===h&&i===b,u=o<h||o===h&&i<b,g=P(),{data:m}=$({month:s});return a(_,{children:[a(S,{alignItems:"center",justifyContent:"flex-start",pl:2,py:2,shadow:"2xl",children:[e(ue,{expense:t}),a(S,{pl:2,flexDirection:"column",alignItems:"flex-start",children:[e(l,{fontWeight:"bold",children:t.name}),e(l,{children:N(t.spentSum)}),e(l,{fontWeight:"hairline",children:q(t.amount)})]}),e(w,{}),a(X,{children:[e(U,{as:z,variant:"outline",icon:e(Q,{}),size:"sm",mr:4}),a(L,{children:[e(E,{icon:e(K,{}),onClick:()=>g(I({modal:"SINGLE_EXPENSE",value:{parentExpense:t.id,date:A?y():new Date(`${s}-${u?xe(o,i).toString():"01"}`).toISOString().split("T")[0],tags:t.tags.map(r=>r.id)}})),children:"Add"}),e(E,{icon:e(O,{}),onClick:()=>g(I({modal:"SCHEDULED_EXPENSE",id:t.id,value:{...t,tags:t.tags.map(r=>r.id)}})),children:"Edit"}),e(E,{icon:e(B,{}),onClick:()=>{g(G({type:"SCHEDULED_EXPENSE",id:t.id,name:t.name}))},children:"Delete"}),t.amount.type==="CONSTANT"&&a(_,{children:[e(ee,{}),e(E,{icon:e(te,{}),onClick:()=>{g(I({modal:"SINGLE_EXPENSE",value:{parentExpense:t.id,amount:t.amount.data.value,name:t.name,date:y()}}))},children:"Create current expense"})]})]})]})]}),(D=(f=m==null?void 0:m.filter(r=>{var d;return((d=r.parentExpense)==null?void 0:d.id)===t.id}))==null?void 0:f.sort((r,d)=>new Date(r.date).getTime()-new Date(d.date).getTime()))==null?void 0:D.map((r,d)=>a(c,{px:2,children:[d!==0&&e(j,{}),e(Y,{expense:r})]},`no_parent_expense_item_${d}`))]})};function xe(n,t){return new Date(n,t,0).getDate()}H.JSX;const k=["#fd7f6f","#7eb0d5","#b2e061","#bd7ebe","#ffb55a","#ffee65","#beb9db","#fdcce5","#8bd3c7"],W=n=>k[n%k.length],be=()=>{const n=Z(r=>r.currentDate.value),{data:t,isFetching:s}=ne({month:n}),i=(t==null?void 0:t.reaming)||0,o=(t==null?void 0:t.budget)||0,C=F(t==null?void 0:t.normalizedReaming)*100,b=F(t==null?void 0:t.normalizedSpent)*100,{data:h,isFetching:A}=ae({month:n}),{data:u,isFetching:g}=$({month:n}),m=h&&h.length>0||u&&u.length>0,f=s||g||A,D=re.exports.useMemo(()=>{const r=[],d=(h||[]).map((p,x)=>e(me,{expense:p},`group_expense_item_${x}`));r.push(...d);const v=(u||[]).filter(p=>!p.parentExpense).sort((p,x)=>new Date(p.date).getTime()-new Date(x.date).getTime()).map((p,x)=>a(c,{px:2,borderRadius:16,shadow:"2xl",children:[x!==0&&e(j,{}),e(Y,{expense:p})]},`single_expense_item_${x}`));return v.length!==0&&r.push(e(c,{children:v},"single_expense_element")),r},[h,u]);return a(c,{p:4,children:[e(oe,{}),a(c,{pt:4,children:[a(S,{alignItems:"center",backgroundColor:"gray.900",borderRadius:16,borderWidth:1,p:4,children:[e(l,{fontSize:"2xl",fontWeight:"hairline",children:"Expenses"}),e(w,{}),f&&e(se,{})]}),!m&&!f&&a(c,{px:6,children:[e(c,{p:8,children:e(ce,{src:"/undraw/moonlight.svg"})}),e(ie,{children:"No data"}),e(l,{fontSize:"2xl",fontWeight:"hairline",children:"Add new expenses with plus button below"})]}),m&&a(c,{maxW:"32em",mb:8,mx:"auto",position:"relative",px:8,children:[e(V,{data:{datasets:[{data:[b,C],backgroundColor:[W(0),W(1)],borderRadius:16,borderWidth:4}]},options:{responsive:!0,spacing:16,cutout:96,events:[]}}),a(c,{left:"50%",position:"absolute",textAlign:"center",top:"50%",transform:"translate(-50%, -50%)",children:[e(l,{fontSize:"md",fontWeight:"thin",children:"Reaming"}),e(l,{fontSize:"3xl",fontWeight:"extrabold",lineHeight:"1.2em",children:N(i)}),e(l,{fontSize:"md",fontWeight:"thin",children:"from"}),e(l,{fontSize:"md",fontWeight:"thin",children:N(o,!0)})]})]})]}),e(le,{children:D})]})},F=(n=0)=>n>1?1:n;export{be as default};
