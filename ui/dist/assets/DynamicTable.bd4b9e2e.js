import{g as ue,j as n,C as W,G as _,c as d,h as le,T as p,d as V,r as l,k as O,I as de,l as pe,B as M,o as H,m as j,n as me,F as N,p as he,q as fe,s as G,V as ge,H as A,t as P,S as F,v as q,w as be,x as xe,y as ve,z as Te,A as Se,D as Ee}from"./index.941be39d.js";import{A as X}from"./AmountTableCell.25ecfd0d.js";import{A as J}from"./ActionButtonsTableCell.4877fb49.js";import{T as E,a as v,b as Q,c as Y,d as Z,e as C,f as K}from"./index.esm.a4d225f8.js";ue.JSX;const ee=r=>{const{date:e,emptyDateComponent:a}=r;return!(e!=null&&e.from)&&!(e!=null&&e.to)?a||n(W,{children:n(_,{})}):d(le,{gap:2,templateColumns:"min-content min-content",children:[n(p,{as:"b",children:"From:"}),n(p,{children:e.from?new Date(e.from).toLocaleDateString():n(_,{})}),n(p,{as:"b",children:"To:"}),n(p,{children:e.to?new Date(e.to).toLocaleDateString():n(_,{})})]})};function ne(r,e){var a,t;switch(r){case"SINGLE_REVENUE":const i=e;return{...i,parentRevenue:(a=i.parentRevenue)==null?void 0:a.id};case"SINGLE_EXPENSE":const o=e;return{...o,parentExpense:(t=o.parentExpense)==null?void 0:t.id};case"SCHEDULED_REVENUE":return{...e};case"SCHEDULED_EXPENSE":const u=e;return{...u,tags:u.tags.map(m=>m.id)}}}const ze=r=>({data:r.data||[],status:r}),re=r=>{const{amount:e}=r,a=isNaN(Number(e))?e:{type:"CONSTANT",data:{value:e}};return n(X,{amount:a})},De=r=>{const{value:e,content:a,isOpen:t,onOpenToggle:i,isLast:o,resourceType:c}=r,u=V();return d(l.exports.Fragment,{children:[d(E,{children:[n(v,{whiteSpace:"break-spaces",w:"100%",borderWidth:o?0:void 0,children:n(O,{in:!t,children:n(p,{children:e.name})})}),n(v,{isNumeric:!0,px:0,borderWidth:o?0:void 0,children:n(O,{in:!t,children:n(re,{amount:e.amount})})}),d(v,{isNumeric:!0,position:"relative",p:0,pr:3,width:"100%",borderWidth:o?0:void 0,children:[n(de,{ml:3,"aria-label":"edit",icon:n(pe,{transition:"all",transitionDuration:".5s",transform:t?"rotate(180deg)":"rotate(0deg)"}),variant:"ghost",onClick:i}),n(M,{position:"absolute",top:"50%",transform:`translate(${t?-100:100}%, -50%)`,opacity:t?1:0,transition:".3s",children:n(J,{onEdit:()=>{u(H({modal:c,value:ne(c,e),id:e.id}))},onDelete:()=>{u(j({type:c,name:e.name,id:e.id}))}})})]})]}),n(E,{children:n(v,{py:0,colSpan:3,whiteSpace:"break-spaces",borderRadius:16,borderColor:"blue",borderWidth:0,children:n(me,{animateOpacity:!0,in:t,children:a})})})]})},te=r=>{const{tags:e}=r;return n(N,{wrap:"wrap",gap:1,children:e.filter(a=>!!a).sort((a,t)=>{var i;return((i=a.name)==null?void 0:i.localeCompare(t.name||""))||0}).map((a,t)=>{var i;return n(he,{size:"sm",borderRadius:"full",variant:"solid",colorScheme:"green",children:n(fe,{children:(i=a.name)==null?void 0:i.toUpperCase()})},`form_selected_tag_${t}`)})})},ae=r=>{const{revenue:e}=r;return e?n(p,{children:`${e.name}`}):n(W,{children:n(G,{})})},oe=r=>{const{expense:e}=r;return e?n(p,{children:`${e.name}`}):n(W,{children:n(G,{})})},Ce=r=>{const{date:e}=r;return e?typeof e=="string"?d(A,{children:[n(p,{as:"b",children:"Date: "}),n(p,{children:new Date(e).toLocaleDateString()})]}):n(ee,{date:e,emptyDateComponent:null}):null},Re=({amount:r})=>n(P,{size:"md",fontWeight:"hairline",pb:2,children:n(re,{amount:r})}),we=({parentExpense:r})=>d(A,{children:[n(p,{as:"b",children:"Parent expense: "}),n(oe,{expense:r})]}),ye=({parentRevenue:r})=>d(A,{children:[n(p,{as:"b",children:"Parent revenue: "}),n(ae,{revenue:r})]}),Ne=r=>{const{value:e,resourceType:a,state:[t,i],isLast:o}=r,c=e.id===t;return n(De,{value:e,isOpen:c,onOpenToggle:()=>i(c?void 0:e.id),isLast:o,resourceType:a,content:d(ge,{py:4,alignItems:"start",children:[n(A,{justifyContent:"space-between",w:"full",children:n(P,{children:e.name})}),"amount"in e&&n(Re,{amount:e.amount}),"date"in e&&n(Ce,{date:e.date}),"parentRevenue"in e&&n(ye,{parentRevenue:e.parentRevenue}),"parentExpense"in e&&n(we,{parentExpense:e.parentExpense}),"tags"in e&&n(te,{tags:e.tags})]})})};function Ae(r,e,a){var t=this,i=l.exports.useRef(null),o=l.exports.useRef(0),c=l.exports.useRef(null),u=l.exports.useRef([]),m=l.exports.useRef(),b=l.exports.useRef(),T=l.exports.useRef(r),s=l.exports.useRef(!0);l.exports.useEffect(function(){T.current=r},[r]);var f=!e&&e!==0&&typeof window<"u";if(typeof r!="function")throw new TypeError("Expected a function");e=+e||0;var x=!!(a=a||{}).leading,D=!("trailing"in a)||!!a.trailing,S="maxWait"in a,L=S?Math.max(+a.maxWait||0,e):null;l.exports.useEffect(function(){return s.current=!0,function(){s.current=!1}},[]);var ie=l.exports.useMemo(function(){var k=function(h){var g=u.current,y=m.current;return u.current=m.current=null,o.current=h,b.current=T.current.apply(y,g)},R=function(h,g){f&&cancelAnimationFrame(c.current),c.current=f?requestAnimationFrame(h):setTimeout(h,g)},$=function(h){if(!s.current)return!1;var g=h-i.current;return!i.current||g>=e||g<0||S&&h-o.current>=L},z=function(h){return c.current=null,D&&u.current?k(h):(u.current=m.current=null,b.current)},I=function h(){var g=Date.now();if($(g))return z(g);if(s.current){var y=e-(g-i.current),ce=S?Math.min(y,L-(g-o.current)):y;R(h,ce)}},w=function(){var h=Date.now(),g=$(h);if(u.current=[].slice.call(arguments),m.current=t,i.current=h,g){if(!c.current&&s.current)return o.current=i.current,R(I,e),x?k(i.current):b.current;if(S)return R(I,e),k(i.current)}return c.current||R(I,e),b.current};return w.cancel=function(){c.current&&(f?cancelAnimationFrame(c.current):clearTimeout(c.current)),o.current=0,u.current=i.current=m.current=c.current=null},w.isPending=function(){return!!c.current},w.flush=function(){return c.current?z(Date.now()):b.current},w},[x,S,e,L,D,f]);return ie}function Le(r,e){return r===e}function B(r){return typeof r=="function"?function(){return r}:r}function se(r,e,a){var t,i,o=a&&a.equalityFn||Le,c=(t=l.exports.useState(B(r)),i=t[1],[t[0],l.exports.useCallback(function(s){return i(B(s))},[])]),u=c[0],m=c[1],b=Ae(l.exports.useCallback(function(s){return m(s)},[m]),e,a),T=l.exports.useRef(r);return o(T.current,r)||(b(r),T.current=r),[u,b]}const ke=r=>{const{resource:{data:e,status:{isFetching:a}},resourceType:t,name:i}=r,o=l.exports.useState(),[c]=se(a,500);return d(M,{borderWidth:1,borderRadius:16,children:[d(N,{p:4,mb:2,alignItems:"center",backgroundColor:"gray.900",borderTopRadius:16,children:[n(p,{fontSize:"2xl",fontWeight:"hairline",children:i}),n(F,{}),c&&n(q,{})]}),n(Q,{overflow:"hidden",width:["100vw",null,null,be.breakpoints.lg],children:d(Y,{overflow:"hidden",children:[n(Z,{children:d(E,{children:[n(C,{children:"Name"}),n(C,{isNumeric:!0,children:"Amount"}),n(C,{isNumeric:!0})]})}),d(K,{children:[e.length===0&&n(E,{children:n(v,{colSpan:3,fontSize:"2xl",fontWeight:"hairline",textAlign:"center",children:"No data"})}),e.length>0&&e.map((u,m)=>n(Ne,{value:u,state:o,resourceType:t,isLast:m===e.length-1},`dynamic_table_${u.id}`))]})]})})]})},U={id:{name:"Id"},name:{name:"Name"},date:{name:"Date"},amount:{name:"Amount",isNumeric:!0},tags:{name:"Tags"},parentExpense:{name:"Parent expense"},parentRevenue:{name:"Parent revenue"},spentFactor:{name:"Spent factor"},spentSum:{name:"Spent sum"},status:{name:"Status"}},Ie=["name","amount","date","parentExpense","parentRevenue","tags"],_e=r=>{const{tableValue:e,tableKey:a}=r,t=e[a];switch(a){case"amount":return typeof t=="number"?n(p,{children:xe(t)}):n(X,{amount:t});case"name":return n(P,{size:"md",children:t});case"date":return typeof t=="string"?n(p,{children:new Date(t).toLocaleDateString()}):n(ee,{date:t});case"parentRevenue":return n(ae,{revenue:t});case"parentExpense":return n(oe,{expense:t});case"tags":return n(te,{tags:t});default:return null}},Fe=r=>{const{resource:{data:e,status:{isFetching:a}},resourceType:t,name:i}=r,[o,c]=l.exports.useState(),u=V(),[m]=se(a,500),b=l.exports.useMemo(()=>{const s=[];return Ie.forEach(f=>{e.forEach(x=>{!s.includes(f)&&x[f]&&s.push(f)})}),s},[e]),T=l.exports.useMemo(()=>{if(!o)return e;const s=[...e].sort(ve(o.column));return o.order==="asc"?s:s.reverse()},[e,o]);return d(M,{borderWidth:1,borderRadius:16,children:[d(N,{p:4,alignItems:"center",borderTopRadius:16,backgroundColor:"gray.900",children:[n(p,{fontSize:"2xl",fontWeight:"hairline",children:i}),n(F,{}),m&&n(q,{})]}),n(Q,{children:d(Y,{children:[n(Z,{children:d(E,{children:[b.map(s=>{const{isNumeric:f,name:x}=U[s];return n(C,{isNumeric:f,children:d(N,{gap:2,alignItems:"center",_hover:{cursor:"pointer"},onClick:()=>{if(!o||o.column!==s){c({column:s,order:"asc"});return}if(o.column===s&&o.order==="asc"){c({column:s,order:"desc"});return}if(o.column===s&&o.order==="desc"){c(void 0);return}},children:[f&&n(F,{}),(o==null?void 0:o.column)===s&&(o.order==="asc"?n(Te,{}):n(Se,{})),x]})},`table_header_${x}`)}),n(C,{isNumeric:!0,children:"Actions"})]})}),d(K,{children:[e.length===0&&n(E,{children:n(v,{colSpan:b.length,fontSize:"2xl",fontWeight:"hairline",textAlign:"center",children:"No data"})}),e.length>0&&T.map((s,f)=>{const x=f===e.length-1;return d(E,{children:[b.map(D=>{const{isNumeric:S}=U[D];return n(v,{isNumeric:S,borderWidth:x?0:void 0,children:n(_e,{tableValue:s,tableKey:D})},`table_data_${D}`)}),n(v,{isNumeric:!0,borderWidth:x?0:void 0,children:n(J,{onEdit:()=>{u(H({modal:t,value:ne(t,s),id:s.id}))},onDelete:()=>{u(j({type:t,name:s.name,id:s.id}))}})})]},`table_row_${s.id}`)})]})]})})]})},Oe=r=>{const{resource:e,resourceType:a,name:t}=r;return Ee({base:!0,md:!1},{fallback:"md"})?n(ke,{resource:e,resourceType:a,name:t}):n(Fe,{resource:e,resourceType:a,name:t})};export{Oe as D,ze as m};
